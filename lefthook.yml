# lefthook.yml
# Git hooks configuration for Type Puzzle project

pre-commit:
  parallel: true
  commands:
    format:
      glob: '*.{js,jsx,ts,tsx,json,md}'
      run: yarn prettier --check {staged_files}
      stage_fixed: false
      # エラー時の自動修正を有効化
      fail_text: |
        フォーマットエラーが検出されました。
        自動修正するには: yarn prettier --write {staged_files}
        または: ./scripts/auto-fix.sh
        
        🤖 Code Reviewerエージェントで自動修正:
        claude "/code-reviewer"

    lint:
      glob: '*.{js,jsx,ts,tsx}'
      exclude: '*.test.{ts,tsx}|*.spec.{ts,tsx}'
      run: yarn eslint {staged_files}
      stage_fixed: false
      fail_text: |
        リントエラーが検出されました。
        自動修正するには: yarn eslint --fix {staged_files}
        または: ./scripts/auto-fix.sh
        
        🤖 Code Reviewerエージェントで自動修正:
        claude "/code-reviewer"

    typecheck:
      run: yarn tsc
      fail_text: |
        型エラーが検出されました。
        Claude Codeに修正を依頼することをお勧めします。
        手動修正後: yarn tsc
        
        🤖 Code Reviewerエージェントで自動修正:
        claude "/code-reviewer"

    test:
      run: yarn test --passWithNoTests
      fail_text: |
        テストが失敗しました。
        詳細を確認して修正してください。

pre-push:
  parallel: false
  commands:
    build:
      run: yarn build
      fail_text: |
        ビルドが失敗しました。
        エラーを修正してから再度プッシュしてください。
